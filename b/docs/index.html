<!DOCTYPE html>
<html lang="en" class="Individual-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Json Web Proof Merkle Disclosure Token</title>
<meta content="Orie Steele" name="author">
<meta content="
       Merkleproofs have been around for a long time, but there has never been a standardd JSON encoding for them. 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="jwp-mdt-00" name="ietf.draft">
<link href="./jwp-mdt-00.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">JWP-MDT</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Steele</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">none</dd>
<dt class="label-individual-draft">Individual-Draft:</dt>
<dd class="individual-draft">jwp-mdt-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-17" class="published">17 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Transmute</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Json Web Proof Merkle Disclosure Token</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Merkleproofs have been around for a long time, but there has never been a standardd JSON encoding for them.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-organization-of-this-docume" class="xref">Organization of this document</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-comparison-with-bbs-signatu" class="xref">Comparison with BBS+ Signatures</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-core-operations" class="xref">Core operations</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-parameters" class="xref">Parameters</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-keyvalidate" class="xref">KeyValidate</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-generate-proof" class="xref">Generate Proof</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-derive-proof" class="xref">Derive Proof</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-verify-proof" class="xref">Verify Proof</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-validating-public-keys" class="xref">Validating public keys</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-disclosure-of-root-nonce" class="xref">Disclosure of root nonce</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-side-channel-attacks" class="xref">Side channel attacks</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-randomness-considerations" class="xref">Randomness considerations</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-choice-of-signature-primiti" class="xref">Choice of Signature Primitive</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-appendix" class="xref">Appendix</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Summary of merkle proofs<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Challenges with proof size<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document describes the Json Web Proof Merkle Disclosure Token.
An encoding for merkle proofs inspired by JWT.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The scheme features many important properties:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-5">
        <li id="section-1-5.1">
          <p id="section-1-5.1.1">Deterministic nonce generation for membership proofs.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-5.2">
          <p id="section-1-5.2.1">Encoding merkle root and related proof data use JWA.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-5.3">
          <p id="section-1-5.3.1">Compressing membership proofs<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-5.4">
          <p id="section-1-5.4.1">Verifying membership proofs<a href="#section-1-5.4.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-1-6">These properties allow the scheme to be used in applications where privacy and data minimization techniques are desired and/or required.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This scheme is meant to expose interfaces compatible with <a href="https://mattrglobal.github.io/bbs-signatures-spec/">BBS+ Signature Scheme</a>. Many of the same benefits from that scheme apply here:<a href="#section-1-7" class="pilcrow">¶</a></p>
<blockquote id="section-1-8">
        <p id="section-1-8.1">A recent emerging use case applies signature schemes in <a href="https://www.w3.org/TR/vc-data-model/">verifiable credentials</a>. One problem with using simple signature schemes like ECSDA or ED25519 is a holder must disclose the entire signed message and signature for verification. Circuit based logic can be applied to verify these in zero-knowledge like SNARKS or Bulletproofs with R1CS but tend to be complicated. BBS+ on the other hand adds, to verifiable credentials or any other application, the ability to do very efficient zero-knowledge proofs. A holder gains the ability to choose which claims to reveal to a relying party without the need for any additional complicated logic.<a href="#section-1-8.1" class="pilcrow">¶</a></p>
</blockquote>
<div id="notational-conventions">
<section id="section-1.1">
        <h3 id="name-notational-conventions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.1-1">The keywords <span class="bcp14">MUST</span>, <span class="bcp14">MUST NOT</span>, <span class="bcp14">REQUIRED</span>, <span class="bcp14">SHALL</span>, <span class="bcp14">SHALL NOT</span>, <span class="bcp14">SHOULD</span>,
<span class="bcp14">SHOULD NOT</span>, <span class="bcp14">RECOMMENDED</span>, <span class="bcp14">MAY</span>, and <span class="bcp14">OPTIONAL</span>, when they appear in this
document, are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">The following terminology is used throughout this document:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">SK</dt>
<dd id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">The secret key for the signature scheme.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.3">PK</dt>
<dd id="section-1.2-2.4">
            <p id="section-1.2-2.4.1">The public key for the signature scheme.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.5">U</dt>
<dd id="section-1.2-2.6">
            <p id="section-1.2-2.6.1">The set of messages to be signed or verified.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.7">M</dt>
<dd id="section-1.2-2.8">
            <p id="section-1.2-2.8.1">The set of messages to be signed or verified paired with their deterministic nonce.<a href="#section-1.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.9">protected</dt>
<dd id="section-1.2-2.10">
            <p id="section-1.2-2.10.1">The protected header to be signed by the JWA scheme.<a href="#section-1.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.11">payload</dt>
<dd id="section-1.2-2.12">
            <p id="section-1.2-2.12.1">The protected payload to be signed by the JWA scheme.<a href="#section-1.2-2.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.13">signature</dt>
<dd id="section-1.2-2.14">
            <p id="section-1.2-2.14.1">The digital signature output.<a href="#section-1.2-2.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.15">nonce</dt>
<dd id="section-1.2-2.16">
            <p id="section-1.2-2.16.1">A cryptographic nonce<a href="#section-1.2-2.16.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.17">path</dt>
<dd id="section-1.2-2.18">
            <p id="section-1.2-2.18.1">A set membership proof, represented as a path in a merkle proof from a leaf to a root.<a href="#section-1.2-2.18.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.19">proofs</dt>
<dd id="section-1.2-2.20">
            <p id="section-1.2-2.20.1">A set of membership proofs, encoded as JSON.<a href="#section-1.2-2.20.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.21">compressedProofs</dt>
<dd id="section-1.2-2.22">
            <p id="section-1.2-2.22.1"><code>proofs</code> compressed and encoded as base64url.<a href="#section-1.2-2.22.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.23">calculateMessageNonce(message, index, rootNonce) -&gt; nonce</dt>
<dd id="section-1.2-2.24">
            <p id="section-1.2-2.24.1">The funtion that takes a message, index and rootNonce and assigns a deterministic nonce for the message.<a href="#section-1.2-2.24.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<div class="artwork art-text alignLeft" id="section-1.2-3">
<pre>const calculateMessageNonce = (
  message: string,
  index: number,
  rootNonce: string
) =&gt; {
  return sha256(message + index + rootNonce);
};
</pre><a href="#section-1.2-3" class="pilcrow">¶</a>
</div>
<dl class="dlParallel" id="section-1.2-4">
          <dt id="section-1.2-4.1">verification</dt>
<dd id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">A boolean representing a proof verification, success as true, failure as false.<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.3">compressProofs(proofs) -&gt; compressedProofs</dt>
<dd id="section-1.2-4.4">
            <p id="section-1.2-4.4.1">The function that takes JSON encoded path based membership proofs and returns a compressed representation of them. Inverse of <code>expandProofs</code>.<a href="#section-1.2-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.5">expandProofs(compressedProofs) -&gt; proofs</dt>
<dd id="section-1.2-4.6">
            <p id="section-1.2-4.6.1">The function that takes a compressed representation of membership proofs and return them in JSON. Inverse of <code>compressProofs</code>.<a href="#section-1.2-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.7">getProofs(messages, rootNonce) -&gt; proofs</dt>
<dd id="section-1.2-4.8">
            <p id="section-1.2-4.8.1">The function that takes a set of messages and a rootNonce and produces a merkle root and membership proofs for each message.<a href="#section-1.2-4.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.9">deriveProofs(disclosureIndexes, proofs, messages, rootNonce) -&gt; compressedProofs</dt>
<dd id="section-1.2-4.10">
            <p id="section-1.2-4.10.1">The function that takes a set of disclosureIndexes, proofs, messages and a rootNonce and produces compressedProofs represenetation of the messages indentified by disclosureIndexes.<a href="#section-1.2-4.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.11">verifyProofs(messages, proofs, root) -&gt; verification</dt>
<dd id="section-1.2-4.12">
            <p id="section-1.2-4.12.1">The function that takes a set messages, proofs and a merkle root, and returns true when all messages have a membership proof that is true, and false otherwise.<a href="#section-1.2-4.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.13">sha256</dt>
<dd id="section-1.2-4.14">
            <p id="section-1.2-4.14.1">The SHA-256 hash function defined in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>.<a href="#section-1.2-4.14.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">//TODO<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="organization-of-this-document">
<section id="section-2.1">
        <h3 id="name-organization-of-this-docume">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-organization-of-this-docume" class="section-name selfRef">Organization of this document</a>
        </h3>
<p id="section-2.1-1">This document is organized as follows:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">The remainder of this section defines terminology and the high-level API.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Section 2 defines primitive operations used in the merkle proof signature scheme. These operations MUST NOT be used alone.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.3">
            <p id="section-2.1-2.3.1">Section 3 defines JSON encoding requirements.<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">Section 4 defines security considerations.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.5">
            <p id="section-2.1-2.5.1">Section 5 defines the references.<a href="#section-2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">Section 6 defines test vectors.<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="comparison-with-bbs-signatures">
<section id="section-2.2">
        <h3 id="name-comparison-with-bbs-signatu">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-comparison-with-bbs-signatu" class="section-name selfRef">Comparison with BBS+ Signatures</a>
        </h3>
<p id="section-2.2-1">Not exactly the same thing, but probably better than comparing to vanilla JWA.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="core-operations">
<section id="section-3">
      <h2 id="name-core-operations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-core-operations" class="section-name selfRef">Core operations</a>
      </h2>
<p id="section-3-1">This section defines core operations used by the schemes defined in Section 3. These operations MUST NOT be used except as described in that section.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="parameters">
<section id="section-3.1">
        <h3 id="name-parameters">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-3.1-1">The core operations in this section depend on several parameters:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">A JWA and JWS, plus associated functionality given in Section 1.4.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">H, a hash function that MUST be a secure cryptographic hash function, e.g. SHA-256.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="keyvalidate">
<section id="section-3.2">
        <h3 id="name-keyvalidate">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-keyvalidate" class="section-name selfRef">KeyValidate</a>
        </h3>
<p id="section-3.2-1">KeyValidate checks if the public key is valid.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">As an optimization, implementations MAY cache the result of KeyValidate in order to avoid unnecessarily repeating validation for known keys.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-3">
<pre>result = KeyValidate(PK)
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">Inputs:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-5.1">
            <p id="section-3.2-5.1.1">PK, a public key<a href="#section-3.2-5.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2-6">Outputs:<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-7.1">
            <p id="section-3.2-7.1.1">result, either VALID or INVALID<a href="#section-3.2-7.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2-8">Procedure:<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">// TODO<a href="#section-3.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generate-proof">
<section id="section-3.3">
        <h3 id="name-generate-proof">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-generate-proof" class="section-name selfRef">Generate Proof</a>
        </h3>
<p id="section-3.3-1">Generate proof computes set membership proofs and a signature from SK, over a vector of messages.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-2">
<pre>{ root, nonce, proofs, signature } = generateProof((message\[i\],...,message\[L\]), SK)
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">Inputs:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3-4.1">
            <p id="section-3.3-4.1.1">message[i],...,message[L], octet strings<a href="#section-3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.3-4.2">
            <p id="section-3.3-4.2.1">SK, a secret key<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.3-5">Outputs:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3-6.1">
            <p id="section-3.3-6.1.1">root, an octet string<a href="#section-3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.3-6.2">
            <p id="section-3.3-6.2.1">nonce, an octet string<a href="#section-3.3-6.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.3-6.3">
            <p id="section-3.3-6.3.1">proofs, an octet string<a href="#section-3.3-6.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.3-6.4">
            <p id="section-3.3-6.4.1">signature, an octet string<a href="#section-3.3-6.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.3-7">Procedure:<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">// TODO<a href="#section-3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="derive-proof">
<section id="section-3.4">
        <h3 id="name-derive-proof">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-derive-proof" class="section-name selfRef">Derive Proof</a>
        </h3>
<p id="section-3.4-1">Derive proof transforms the output of generate proof filtering the set membership proofs
to match the intended messages to be disclosed and applying the nonce algorithm.
This process is also referred to as generating a selective disclosure proof.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4-2">
<pre>{ root, proofs, signature } = deriveProof(
  (disclosureIndexes[i],...,disclosureIndexes[L]),
  (message[i],...,message[L]),
  (proof[i],...,proof[L]),
  root,
  nonce,
  signature
)
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4-3">Inputs:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4-4.1">
            <p id="section-3.4-4.1.1">disclosureIndexes[i],...,disclosureIndexes[L], octet integer.<a href="#section-3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-4.2">
            <p id="section-3.4-4.2.1">message[i],...,message[L], octet strings.<a href="#section-3.4-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-4.3">
            <p id="section-3.4-4.3.1">proof[i],...,proof[L], octet strings.<a href="#section-3.4-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-4.4">
            <p id="section-3.4-4.4.1">root, octet string.<a href="#section-3.4-4.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-4.5">
            <p id="section-3.4-4.5.1">nonce, octet string.<a href="#section-3.4-4.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-4.6">
            <p id="section-3.4-4.6.1">signature, octet string.<a href="#section-3.4-4.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.4-5">Outputs:<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4-6.1">
            <p id="section-3.4-6.1.1">root, octet string, unchanged by function.<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-6.2">
            <p id="section-3.4-6.2.1">proofs, octet string.<a href="#section-3.4-6.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-6.3">
            <p id="section-3.4-6.3.1">signature, octet string, unchanged by function.<a href="#section-3.4-6.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.4-7">Procedure:<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">//TODO<a href="#section-3.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify-proof">
<section id="section-3.5">
        <h3 id="name-verify-proof">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-verify-proof" class="section-name selfRef">Verify Proof</a>
        </h3>
<p id="section-3.5-1">Verify checks that a proof is valid for the octet string messages under the public key.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.5-2">
<pre>verification = Verify((message[i],...,message[L]), (proof[i],...,proof[L]), root, signature, PK)
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5-3">Inputs:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.5-4.1">
            <p id="section-3.5-4.1.1">message[i],...,message[L], octet strings.<a href="#section-3.5-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-4.2">
            <p id="section-3.5-4.2.1">proof[i],...,proof[L], octet strings.<a href="#section-3.5-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-4.3">
            <p id="section-3.5-4.3.1">root, octet string.<a href="#section-3.5-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-4.4">
            <p id="section-3.5-4.4.1">signature, octet string.<a href="#section-3.5-4.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-4.5">
            <p id="section-3.5-4.5.1">PK, a public key<a href="#section-3.5-4.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.5-5">Outputs:<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.5-6.1">
            <p id="section-3.5-6.1.1">verification, either VALID or INVALID.<a href="#section-3.5-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.5-7">Procedure:<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">// TODO<a href="#section-3.5-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="validating-public-keys">
<section id="section-4.1">
        <h3 id="name-validating-public-keys">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-validating-public-keys" class="section-name selfRef">Validating public keys</a>
        </h3>
<p id="section-4.1-1">All algorithms in Section 2 that operate on public keys require first validating those keys.
For the sign, verify and proof schemes, the use of KeyValidate is REQUIRED.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="disclosure-of-root-nonce">
<section id="section-4.2">
        <h3 id="name-disclosure-of-root-nonce">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-disclosure-of-root-nonce" class="section-name selfRef">Disclosure of root nonce</a>
        </h3>
<p id="section-4.2-1">If the root nonc associatd with a merkle root is disclosed, a verifier or attacker can compute adjcacent membership proofs from sets of disclosed proofs.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="side-channel-attacks">
<section id="section-4.3">
        <h3 id="name-side-channel-attacks">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-side-channel-attacks" class="section-name selfRef">Side channel attacks</a>
        </h3>
<p id="section-4.3-1">Implementations of the signing algorithm SHOULD protect the secret key from side-channel attacks. One method for protecting against certain side-channel attacks is ensuring that the implementation executes exactly the same sequence of instructions and performs exactly the same memory accesses, for any value of the secret key. ( this copied verbatum form <a href="https://raw.githubusercontent.com/mattrglobal/bbs-signatures-spec/master/spec.md">here</a>).<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="randomness-considerations">
<section id="section-4.4">
        <h3 id="name-randomness-considerations">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-randomness-considerations" class="section-name selfRef">Randomness considerations</a>
        </h3>
<p id="section-4.4-1">It is recommended that the all nonces are from a trusted source of randomness.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-signature-primitive">
<section id="section-4.5">
        <h3 id="name-choice-of-signature-primiti">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-choice-of-signature-primiti" class="section-name selfRef">Choice of Signature Primitive</a>
        </h3>
<p id="section-4.5-1">TODO: comment on JOSE / COSE.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document does not make any requests of IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">TODO:<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Request for JOSE and COSE...:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-5-4.1">
          <p id="section-5-4.1.1">alg: MDP+ES256+JP<a href="#section-5-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-4.2">
          <p id="section-5-4.2.1">alg: MDP+ES384+JP<a href="#section-5-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5-4.3">
          <p id="section-5-4.3.1">etc...<a href="#section-5-4.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="appendix">
<section id="section-6">
      <h2 id="name-appendix">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-appendix" class="section-name selfRef">Appendix</a>
      </h2>
<ul>
<li id="section-6-1.1">
          <p id="section-6-1.1.1">JSON Web Signature (JWS) - <a href="https://tools.ietf.org/html/rfc7515">RFC7515</a><a href="#section-6-1.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.2">
          <p id="section-6-1.2.1">JSON Web Encryption (JWE) - <a href="https://tools.ietf.org/html/rfc7516">RFC7516</a><a href="#section-6-1.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.3">
          <p id="section-6-1.3.1">JSON Web Key (JWK) - <a href="https://tools.ietf.org/html/rfc7517">RFC7517</a><a href="#section-6-1.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.4">
          <p id="section-6-1.4.1">JSON Web Algorithms (JWA) - <a href="https://tools.ietf.org/html/rfc7518">RFC7518</a><a href="#section-6-1.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.5">
          <p id="section-6-1.5.1">JSON Web Token (JWT) - <a href="https://tools.ietf.org/html/rfc7519">RFC7519</a><a href="#section-6-1.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.6">
          <p id="section-6-1.6.1">JSON Web Key Thumbprint - <a href="https://tools.ietf.org/html/rfc7638">RFC7638</a><a href="#section-6-1.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.7">
          <p id="section-6-1.7.1">JWS Unencoded Payload Option - <a href="https://tools.ietf.org/html/rfc7797">RFC7797</a><a href="#section-6-1.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6-1.8">
          <p id="section-6-1.8.1">CFRG Elliptic Curve ECDH and Signatures - <a href="https://tools.ietf.org/html/rfc8037">RFC8037</a><a href="#section-6-1.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
<div id="test-vectors">
<section id="section-6.1">
        <h3 id="name-test-vectors">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
        </h3>
<p id="section-6.1-1">//TODO<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-normative-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC6234">[RFC6234]</dt>
<dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Transmute</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@transmute.industries" class="email">orie@transmute.industries</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
